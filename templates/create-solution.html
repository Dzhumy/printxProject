{% extends 'base.html' %}

{% block title %}
PrintX Create Solution Page
{% endblock %}

{% block script %}
<script src='https://cdn.plot.ly/plotly-2.16.1.min.js'></script>
{% endblock %}

{% block body %}
<div class="container">
    {% if is_result %}
        <div id="myDiv">
            {{ plotly_figure|safe }}
        </div>
        <h3>Completed Orders</h3> <br>
        <table class="table table-striped table-hover align-middle text-center">
            <thead>
                <tr>
                    <th scope="col">Order Name</th>
                    <th scope="col">Profit</th>
                    <th scope="col">Produced quantity</th>
                    <th scope="col">Minimum Demand</th>
                    <th scope="col">Status</th>
                </tr>
            </thead>
            <tbody>
                {% for item in output_list %}
                      <tr>
                            <td>{{ item.order }}</td>
                            <td>{{ '%0.2f' % item.profit }} &euro;</td>
                            <td>{{ item.produced }}</td>
                            <td>{{ item.minimum_demand }} </td>
                            {% if item.status == 'ENOUGH' %}
                                <td style="color:green" class="fw-semibold">{{ item.status }}</td>
                            {% elif item.status == '! EXTRA !' %}
                                <td style="color:orange" class="fw-bolder">{{ item.status }}</td>
                            {% else %}
                                <td style="color:red" class="fw-bold">{{ item.status }}</td>
                            {% endif %}
                      </tr>
                {% endfor %}
                <tr class="fw-bold">
                    <td>Total</td>
                    <td>{{'%0.2f' % output_list|sum(attribute='profit')}} &euro;</td>
                    <td>{{output_list|sum(attribute='produced')}}</td>
                    <td>{{output_list|sum(attribute='minimum_demand')}}</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <script>
            let data =  {{ figure| safe }}

            let layout = {
                title: 'Responsive to window\'s size!',
                font: {size: 18}
            };

            let config = {responsive: true}

            Plotly.newPlot('myDiv', data, layout, config);

             window.onresize = function() {
                Plotly.Plots.resize(myDiv);
            }
        </script>
    {% else %}
        <div class="h4 pb-2 mb-4 text-danger border-bottom border-danger">
            Error
        </div>
        <h1 class="text-center">NO RESULT</h1>
    {% endif %}
</div>

{% endblock %}


